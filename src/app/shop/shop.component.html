<!-- @format -->

<div class="imacontainer">
    <div class="subheader position-relative">
        <div class="subheadings">
            <h2 class="text-uppercase">Shop</h2>
        </div>
        <img src="assets/images/contestant-headerbg.jpg" class="img-fluid" />
    </div>
    <div
        class="content-middle shop-section position-relative"
    >
        <div class="topcartright clearfix" *ngIf="sessionService.isAuth">
            <div class="cartsection text-center">
                <div class="position-relative" [routerLink]="['/cart']">
                    <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                    <span class="rounded-circle cartcount"  *ngIf="productList && productList.cart_count && productList.cart_count !== 0">{{productList.cart_count}}</span>
                </div>
            </div>
        </div>
        <div class="shopsearch position-relative">
            <div class="row">
                <div class="col-md-12">
                    <form>
                        <div class="row align-items-center shoptopsearch">
                            <div
                                class="col-md-4 my-1 searchinput position-relative"
                            >
                                <input
                                    type="text"
                                    class="form-control"
                                    [(ngModel)]="q"
                                    [ngModelOptions]="{standalone: true}"
                                    id="inlineFormInputName"
                                    placeholder="Search for items"
                                />
                                <span class="search-icon"></span>
                            </div>
                            <div
                                class="col-md-2 my-1 searchinput position-relative"
                            >
                            <div ngbDropdown class="d-inline-block dropdown">
                                <button type="button" class="btn btn-outline-primary" ngbDropdownToggle>{{filterBy}}</button>
                                <div ngbDropdownMenu>
                                    <button type="button" class="dropdown-item" (click)="role(0, 'Filter By All')">Filter By All</button>
                                    <button type="button" class="dropdown-item" (click)="role(1, 'Filter By Contestant')">Filter By Contestant</button>
                                    <button type="button" class="dropdown-item" (click)="role(2, 'Filter By IMA')">Filter By IMA</button>
                                </div>
                            </div>
                            </div>
                            <div class="col-auto my-1 shop-srbtn">
                                <button
                                    type="button"
                                    (click)="getProducts()"
                                    class="btn btn-dark text-uppercase"
                                >
                                    Search
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div
            class="row shoplisting"
            *ngFor="let product of productDetails; let productIndex = index; trackBy: trackById"
        >
            <div class="col-lg-7 col-md-6">
                <div class="cartimglisting d-flex">
                    <div class="mr-3 cartmiouter">
                        <div class="cartmainimage position-relative">
                            <app-attachment
                                [attachment]="product.showDetail.panelImage"
                                [type]="original"
                                [cssClass]="'shopattimage'"
                            ></app-attachment>
                            <a href="javascript:void(0)" (click)="redirect(product.user)" class="cartuserimg">
                                <app-attachment
                                [attachment]="product.user.attachment"
                                [type]="original"
                                [cssClass]="'rounded-circle'"
                            ></app-attachment>
                            </a>
                        </div>
                    </div>
                    <div class="cartlistthumbnails" *ngIf="product.showDetail.attachments.length > 1">
                        <a href="javascript:void(0)" class="mb-3" *ngFor="let attachmentDetail of product.showDetail.attachments" (click)="changeImage(product, attachmentDetail)">
                            <app-attachment
                            [attachment]="attachmentDetail"
                            [type]="original"
                            [cssClass]="'shopattimage'"
                        ></app-attachment>
                        </a>
                    </div>
                </div>
                <div class="slectcolors">
                    <span class="text-uppercase availcoltext mr-3"
                        >Available Colors</span
                    >
                    <span>
                        <a *ngFor="let color of product.colors; let i = index;trackBy: trackById"
                            href="javascript:void(0)"
                            (click)="changeDetail(productIndex, i)"
                            [ngClass]="{'active': color.isactive}"
                            [ngStyle]="{'background-color': color.color}"
                            class="availcolorsselect ml-2"
                        ></a>
                    </span>
                </div>
            </div>
            <div class="col-md-5">
                <form>
                    <div class="shopqtyarea d-flex justify-content-end" *ngIf="sessionService.isAuth">
                        <div class="cartquantity text-center">
                            <p class="text-uppercase ctqtytext">Quantity</p>
                            <div class="ctquantityinput">
                                <button type="button" class="ctqtydecr" (click)="removeQuantity(product)"></button>
                                <span class="quantityinput">{{product.showDetail.cart && product.showDetail.cart.quantity ? product.showDetail.cart.quantity : 0 }}</span>
                                <button type="button" class="ctqtyincr" (click)="addQuantity(product)"></button>
                            </div>
                            <p class="mt-2 quntyremain m-0">
                                Only {{ product.showDetail.amount_detail.quantity}} items left
                            </p>
                        </div>
                    </div>
                    <div class="productcartdesc">
                        <h2 class="m-0 mb-1 p-0 text-truncate">
                            {{ product.name }}
                        </h2>
                        <p>
                            {{ product.description }}
                        </p>
                    </div>
                    <div class="product-availsizes" *ngIf="product.showDetail.sizes.length > 1">
                        <span class="text-uppercase">Available Sizes</span>
                        <a href="javascript:void(0)" class="text-uppercase" [ngClass]="{'active': size.isactive}" *ngFor="let size of product.showDetail.sizes" (click)="chooseSize(size, product)">{{size.size.name}}</a>
                    </div>
                    <div class="d-flex justify-content-end mt-1">
                        <div class="d-flex flex-column cartdetails">
                            <p class="text-center discount-details m-0 mt-1" *ngIf="sessionService.isAuth && product.showDetail.amount_detail.discount_percentage">
                                <span>{{ product.showDetail.amount_detail.discount_percentage}}% discount</span> <span *ngIf="!product.showDetail.cart.coupon.isValid">available</span> <span *ngIf="product.showDetail.cart.coupon.isValid">applied</span>
                                
                            </p>
                            <input *ngIf="sessionService.isAuth && product.showDetail.amount_detail.discount_percentage"
                                [(ngModel)]="product.showDetail.cart.coupon.coupon_code"
                                [ngModelOptions]="{standalone: true}"
                                class="discountcode text-center text-uppercase"
                                placeholder="Enter Code"
                            />
                            <button class="btn btn-primary cart-btn mt-4" type="button" (click)="addToCart(product)">
                                <i
                                    class="fa fa-shopping-cart"
                                    aria-hidden="true"
                                ></i>
                                {{ product.showDetail.amount_detail.price | currency: settings.CURRENCY_CODE:'symbol' }}
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="content-middle contestants-section" *ngIf="isNodata">
        <div class="row mb-4">
            <div class="col-md-7">
                No Records
            </div>
        </div>
    </div>
</div>
